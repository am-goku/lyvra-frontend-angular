<div class="min-h-screen bg-gray-50 flex flex-col lg:flex-row">
  <!-- Overlay (mobile only) -->
  @if (sidebarOpen()) {
    <div
      class="fixed inset-0 bg-black/60 z-40 lg:hidden"
      (click)="sidebarOpen.set(false)"
    ></div>
  }

  <!-- Sidebar -->
  <aside
    [class.translate-x-0]="sidebarOpen()"
    [class.-translate-x-full]="!sidebarOpen()"
    class="fixed top-0 left-0 h-screen w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out z-50 lg:translate-x-0 lg:static lg:z-auto"
  >
    <div class="flex items-center justify-between h-16 px-5 border-b">
      <h2 class="text-xl font-bold text-gray-900">Admin Panel</h2>
      <button (click)="sidebarOpen.set(false)" class="lg:hidden">
        <lucide-icon [img]="icons.x" class="w-6 h-6 text-gray-600"></lucide-icon>
      </button>
    </div>

    <nav class="mt-4 px-3">
      @for (item of navItems; track item.route) {
        <div>
          <a
            [routerLink]="item.route"
            routerLinkActive="bg-indigo-50 text-indigo-700 border-l-4 border-indigo-600"
            [routerLinkActiveOptions]="{ exact: item.route === '/admin' }"
            class="flex items-center px-3 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 hover:text-indigo-700 rounded-md transition-colors border-l-4 border-transparent"
          >
            <lucide-icon [img]="item.icon" class="w-5 h-5 mr-3"></lucide-icon>
            <span class="flex-1">{{ item.label }}</span>
            @if (item.tabs?.length) {
              <lucide-icon [img]="icons.chevronRight" class="w-4 h-4 text-gray-400"></lucide-icon>
            }
          </a>

          <!-- Sub-tabs (mobile: indented, desktop: indented) -->
          @if (item.tabs && isActiveParent(item.route)) {
            <div class="ml-8 mt-1 space-y-1 border-l-2 border-gray-200 pl-3">
              @for (tab of item.tabs; track tab.route) {
                <a
                  [routerLink]="tab.route"
                  routerLinkActive="text-indigo-700 font-medium"
                  class="block px-2 py-1.5 text-sm text-gray-600 hover:text-indigo-700 rounded transition-colors"
                >
                  {{ tab.label }}
                </a>
              }
            </div>
          }
        </div>
      }
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col">
    <!-- Header -->
    <header class="bg-white shadow-sm md:hidden border-b border-gray-200 sticky top-0 z-30">
      <div class="px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <button
            (click)="toggleSidebar()"
            class="p-2 rounded-md text-gray-600 hover:bg-gray-100 lg:hidden"
          >
            <lucide-icon [img]="icons.menu" class="w-6 h-6"></lucide-icon>
          </button>
          <div class="flex-1"></div>
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="flex-1 overflow-y-auto">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Tabs (Responsive Horizontal Scroll) -->
        @if (currentNavItem()?.tabs) {
          <div class="mb-6 -mx-4 sm:mx-0 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300">
            <nav class="flex space-x-6 px-4 sm:px-0 whitespace-nowrap">
              @for (tab of currentNavItem()!.tabs!; track tab.route) {
                <a
                  [routerLink]="tab.route"
                  routerLinkActive="border-indigo-500 text-indigo-600"
                  [routerLinkActiveOptions]="{ exact: true }"
                  class="py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors"
                >
                  {{ tab.label }}
                </a>
              }
            </nav>
          </div>
        }

        <!-- Page Content -->
        <div class="bg-white rounded-lg shadow-sm p-4 sm:p-6 lg:p-8 min-h-full">
          <router-outlet />
        </div>
      </div>
    </main>
  </div>
</div>